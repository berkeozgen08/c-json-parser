TODO: memory management  
TODO: add error information
